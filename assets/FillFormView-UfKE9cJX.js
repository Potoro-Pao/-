import{_ as L,H as g,I as S,J as w,K as E,M as O,N as T,O as F,L as N,m as k,h as y,T as U,P as A,r as h,o as _,c as b,a,e,w as D,F as f,y as I,A as n,D as m,E as q,G as P,Q as R,R as Y,b as p}from"./index-Kc8cdeaF.js";import{a as z}from"./axios-L6U4YIEh.js";import{c as v}from"./cartStore-vbYV3YKm.js";import{c as B}from"./confirmOrderDataStore-vqL-A-4f.js";import{S as H}from"./StepperComponent-VZBZhXIN.js";var J={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_API:"potoro",BASE_URL:"/VueMission1/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:Z,VITE_API:j}=J;g("required",R);g("email",Y);S({generateMessage:w({en:E.messages}),validateOnInput:!0});const G={components:{VForm:O,VField:T,ErrorMessage:F,Loading:N,StepperComponent:H},data(){return{isLoading:!0,orderModal:null,user:{email:"",name:"",tel:"",country:"",city:"",address:"",message:""}}},computed:{...k(v,["cart","final_total","total","discount"])},methods:{...y(v,["getCart","deleteCartPinia"]),...y(B,["storeData"]),sendOrder(){const l={data:{user:{name:this.user.name,email:this.user.email,tel:this.user.tel,address:JSON.stringify({address:this.user.address,country:this.user.country,city:this.user.city})},message:this.user.message}};this.isLoading=!0,this.showToast("Order submitted successfully","success");const s=`${Z}/api/${j}/order`;z.post(s,l).then(r=>{this.isLoading=!1,this.getCart(),this.storeData(r.data),this.$router.push({path:"/checkorder"})})},onSubmit(){this.sendOrder()},isPhone(l){const r=/^(09)[0-9]{8}$/.test(l)?!0:"Telephone is required.";return r&&l&&l.length<8?"The length must be at least 8 digits.":r},isCity(l){return/^[A-Z][a-z]*$/.test(l)?!0:"City is required and start with Uppercase."},isCountry(l){return/^[A-Z][a-z]*$/.test(l)?!0:"Country is required and start with Uppercase."},showToast(l,s){const r=document.createElement("div");r.classList.add("toast","align-items-center","text-white",s==="success"?"bg-success":"bg-danger","border-0","position-fixed","top-0","end-0","m-3"),r.role="alert",r.innerHTML=`
    <div class="d-flex">
      <div class="toast-body">
        <i class="bi bi-check-circle"></i> ${l}
      </div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
  `,document.body.appendChild(r),new U(r,{autohide:!0,delay:2e3}).show()}},mounted(){this.orderModal=new A(this.$refs.orderModal),this.isLoading=!1}},K={class:"container my-5"},Q={class:"container"},W={class:"row justify-content-center"},X={class:"col-md-6"},$=e("div",{class:"container mb-5"},[e("h1",null,"Complete Your Information")],-1),ee={class:"mb-3"},se=e("label",{for:"email"},[p("Email "),e("span",{class:"text-danger"},"*")],-1),te={class:"mb-3"},oe=e("label",{for:"name"},[p("Name "),e("span",{class:"text-danger"},"*")],-1),ae={class:"mb-3"},le=e("label",{for:"phone"},[p("Telephone "),e("span",{class:"text-danger"},"*")],-1),ie={class:"mb-3"},re=e("label",{for:"country"},[p("Country "),e("span",{class:"text-danger"},"*")],-1),ne={class:"mb-3"},de=e("label",{for:"city"},[p("City "),e("span",{class:"text-danger"},"*")],-1),ce={class:"mb-3"},ue=e("label",{for:"address"},[p("Address "),e("span",{class:"text-danger"},"*")],-1),me={class:"mb-3"},pe=e("label",{for:"message"},"Message",-1),he=e("div",{class:"text-end"},[e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger text-white"}," Review Order ")])],-1),_e={class:"modal right fade",ref:"orderModal",tabindex:"-1",role:"dialog","aria-labelledby":"orderModalLabel","aria-hidden":"true"},be={class:"modal-dialog",role:"document"},ye={class:"modal-content"},fe=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"orderModalLabel"},"Order Summary"),e("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[e("span",{"aria-hidden":"true"},"Ã—")])],-1),ve={class:"modal-body"},ge=e("hr",null,null,-1),Ve={class:"text-success"},Ce={class:"text-danger"},xe={class:"modal-footer"};function Me(l,s,r,V,t,d){const C=h("Loading"),x=h("StepperComponent"),c=h("VField"),u=h("ErrorMessage"),M=h("VForm");return _(),b(f,null,[a(C,{active:t.isLoading,"onUpdate:active":s[0]||(s[0]=o=>t.isLoading=o)},null,8,["active"]),e("div",K,[a(x,{currentStep:2})]),e("div",Q,[e("div",W,[e("div",X,[$,a(M,{ref:"orderForm",onSubmit:d.onSubmit},{default:D(({errors:o})=>[e("div",ee,[se,a(c,{id:"email",name:"email",type:"email",class:m(["form-control",{"is-invalid":o.email}]),placeholder:"Your Email",rules:"email|required",modelValue:t.user.email,"onUpdate:modelValue":s[1]||(s[1]=i=>t.user.email=i)},null,8,["class","modelValue"]),a(u,{name:"email",class:"invalid-feedback"})]),e("div",te,[oe,a(c,{id:"name",name:"name",type:"text",class:m(["form-control",{"is-invalid":o.name}]),placeholder:"Your Name",rules:"required",modelValue:t.user.name,"onUpdate:modelValue":s[2]||(s[2]=i=>t.user.name=i)},null,8,["class","modelValue"]),a(u,{name:"name",class:"invalid-feedback"})]),e("div",ae,[le,a(c,{id:"phone",name:"phone",type:"tel",class:m(["form-control",{"is-invalid":o.phone}]),placeholder:"Telephone",rules:d.isPhone,modelValue:t.user.tel,"onUpdate:modelValue":s[3]||(s[3]=i=>t.user.tel=i)},null,8,["class","rules","modelValue"]),a(u,{name:"phone",class:"invalid-feedback"})]),e("div",ie,[re,a(c,{id:"country",name:"country",class:m(["form-control",{"is-invalid":o.country}]),placeholder:"Your Country",rules:d.isCountry,modelValue:t.user.country,"onUpdate:modelValue":s[4]||(s[4]=i=>t.user.country=i)},null,8,["class","rules","modelValue"]),a(u,{name:"country",class:"invalid-feedback"})]),e("div",ne,[de,a(c,{id:"city",name:"city",class:m(["form-control",{"is-invalid":o.city}]),placeholder:"Your City",rules:d.isCity,modelValue:t.user.city,"onUpdate:modelValue":s[5]||(s[5]=i=>t.user.city=i)},null,8,["class","rules","modelValue"]),a(u,{name:"city",class:"invalid-feedback"})]),e("div",ce,[ue,a(c,{id:"address",name:"address",type:"text",class:m(["form-control",{"is-invalid":o.address}]),placeholder:"Address",rules:"required",modelValue:t.user.address,"onUpdate:modelValue":s[6]||(s[6]=i=>t.user.address=i)},null,8,["class","modelValue"]),a(u,{name:"address",class:"invalid-feedback"})]),e("div",me,[pe,q(e("textarea",{id:"message",class:"form-control",rows:"10",placeholder:"Write something","onUpdate:modelValue":s[7]||(s[7]=i=>t.user.message=i)},null,512),[[P,t.user.message]])]),he]),_:1},8,["onSubmit"])])])]),e("div",_e,[e("div",be,[e("div",ye,[fe,e("div",ve,[(_(!0),b(f,null,I(this.cart,o=>(_(),b("div",{key:o.id},[e("div",null,[e("strong",null,n(o.product.title),1)]),e("div",null,"$"+n(o.product.price),1)]))),128)),ge,e("p",null,"Origin Price: "+n(this.total),1),e("p",Ve,"Discount: "+n(this.discount),1),e("p",null,"Email: "+n(t.user.email),1),e("p",null,"Your Name: "+n(t.user.name),1),e("p",Ce,"Total Amount: $"+n(this.final_total),1)]),e("div",xe,[e("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",onClick:s[8]||(s[8]=(...o)=>l.closeOrderModal&&l.closeOrderModal(...o))}," Close "),e("button",{type:"button",onClick:s[9]||(s[9]=(...o)=>d.sendOrder&&d.sendOrder(...o)),class:"btn btn-primary"}," Confirm Order ")])])])],512)],64)}const Te=L(G,[["render",Me]]);export{Te as default};
